<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EJECT | OKRs, KPIs e BPMN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/x-icon" href="/EJECT_Trilha_de_Conhecimento/img/svgs/logo-eject.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@200;300;400;500;600;700;900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body {
            font-family: "Exo 2", sans-serif;
            background: linear-gradient(275.04deg, rgb(228, 243, 255) 1.05%, rgb(244, 246, 251) 100%);
            color: white;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transition: background-color 0.3s, color 0.3s;
        }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: #0284c7; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #0369a1; }
        code {
            background-color: #e5e7eb; color: #be123c; padding: 0.125rem 0.25rem;
            border-radius: 0.25rem; font-size: 0.875em;
        }
        .vw-plugin-wrapper { z-index: 1000 !important; }
        .aspect-w-16 { position: relative; padding-bottom: calc(9 / 16 * 100%); }
        .aspect-h-9 > * { position: absolute; height: 100%; width: 100%; top: 0; right: 0; bottom: 0; left: 0; }

        .btn-gemini {
            background: linear-gradient(92.07deg, #652CD1 1.84%, #8E2DE2 100%); color: white;
            font-weight: 600; padding: 0.625rem 1.25rem; border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            transition: all 0.3s ease; border: none; cursor: pointer;
        }
        .btn-gemini:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(101,44,209,0.4), 0 4px 6px -2px rgba(101,44,209,0.3);
        }
        .btn-gemini:disabled { opacity: 0.7; cursor: not-allowed; }

        .loading-spinner-gemini, .loading-spinner-pdf {
            border: 4px solid rgba(255,255,255,0.2); width: 24px; height: 24px;
            border-radius: 50%; border-left-color: #A78BFA;
            animation: spin 1s ease infinite; margin: 10px auto;
        }
        .loading-spinner-pdf { border-left-color: #38bdf8; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .modal-backdrop {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.6); display: flex; justify-content: center;
            align-items: center; z-index: 1050; opacity: 0; visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-backdrop.active { opacity: 1; visibility: visible; }
        .modal-content {
            background-color: white; color: #374151; padding: 2rem;
            border-radius: 0.75rem; box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            width: 90%; max-width: 500px;
            max-height: 90vh; overflow-y: auto; transform: translateY(-50px);
            transition: transform 0.3s ease;
        }
        .modal-backdrop.active .modal-content { transform: translateY(0); }
        .modal-header {
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #e5e7eb; padding-bottom: 1rem; margin-bottom: 1rem;
        }
        .modal-title { font-size: 1.25rem; font-weight: 600; color: #1e40af; }
        .modal-close-btn {
            background: none; border: none; font-size: 1.75rem; font-weight: bold;
            color: #6b7280; cursor: pointer; padding: 0.5rem; line-height: 1;
        }
        .modal-close-btn:hover { color: #1f2937; }
        .modal-body { margin-bottom: 1.5rem; }
        .modal-body pre {
            background-color: #f3f4f6; padding: 1rem; border-radius: 0.5rem;
            white-space: pre-wrap; word-wrap: break-word; font-size: 0.9rem;
            max-height: 40vh; overflow-y: auto;
        }
        .podcast-iframe-container { margin-top: 0.5rem; }
        .podcast-iframe-container iframe { max-width: 100%; border-radius: 0.375rem; }

        #qrcodeCanvas {
            width: 200px; height: 200px; margin: 1.5rem auto; padding: 10px;
            background-color: white; border-radius: 0.5rem; box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        #qrcodeCanvas img { display: block; width: 100% !important; height: 100% !important; }
        .copy-link-btn { background-color: #0ea5e9; color: white; }
        .copy-link-btn:hover { background-color: #0284c7; }

        .pdf-feedback {
            position: fixed; bottom: 20px; left: 50%;
            transform: translateX(-50%);
            color: white; padding: 10px 20px; border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2); z-index: 2000;
            display: none; font-size: 0.9rem;
        }
        .pdf-feedback.success { background-color: #22c55e; }
        .pdf-feedback.error { background-color: #ef4444; }

        /* Accessibility Panel Styles */
        #accessibilityToolbar {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1060;
        }
        #accessibilityBtn {
            background-color: #1e40af;
            color: white;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #accessibilityBtn:hover {
            background-color: #1c3a94;
        }
        #accessibilityPanel {
            position: absolute;
            bottom: 70px;
            right: 0;
            width: 280px;
            background-color: white;
            color: #374151;
            border-radius: 0.5rem;
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
            padding: 1rem;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease;
        }
        #accessibilityPanel.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        .accessibility-section { margin-bottom: 1rem; }
        .accessibility-section h4 {
            font-size: 0.875rem;
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 0.5rem;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 0.25rem;
        }
        .accessibility-controls button, .accessibility-controls select, .accessibility-controls input[type="range"] {
            width: 100%;
            text-align: left;
            padding: 0.5rem 0.75rem;
            margin-top: 0.25rem;
            border-radius: 0.375rem;
            border: 1px solid #d1d5db;
            background-color: #f9fafb;
            color: #374151;
            font-size: 0.875rem;
            transition: background-color 0.2s;
        }
        .accessibility-controls button:hover, .accessibility-controls select:hover {
            background-color: #f3f4f6;
        }
        .accessibility-controls button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        .tts-controls button { margin-right: 0.5rem; width: auto; }
        .accessibility-controls label {
            display: block;
            font-size: 0.75rem; /* text-xs */
            color: #4b5563; /* text-gray-600 */
            margin-top: 0.5rem;
            margin-bottom: 0.125rem;
        }
        .accessibility-controls input[type="range"] {
            padding: 0; /* Remover padding padr√£o do range */
            height: 1.25rem; /* Ajustar altura */
        }

        /* High Contrast Themes - REVISADO */
        body.contrast-bw { background: black !important; color: white !important; }
        body.contrast-bw header, body.contrast-bw .bg-white { background-color: black !important; color: white !important; border-color: #555 !important; }
        body.contrast-bw [class*="text-gray-"], body.contrast-bw [class*="text-sky-"], body.contrast-bw [class*="text-violet-"] { color: white !important; }
        body.contrast-bw .text-sky-700, body.contrast-bw .text-sky-800, body.contrast-bw .text-sky-600, body.contrast-bw .text-violet-700 { color: #FFFF00 !important; }
        body.contrast-bw a:not(.btn-gemini) { color: #FFFF00 !important; text-decoration: underline !important; }
        body.contrast-bw button:not(#accessibilityBtn):not(.btn-gemini):not(.modal-close-btn):not(.copy-link-btn) { background-color: #222 !important; color: white !important; border-color: white !important; }
        body.contrast-bw .copy-link-btn { background-color: #222 !important; color: white !important; border-color: white !important; }
        body.contrast-bw .modal-content { background-color: black !important; color: white !important; border-color: #555 !important;}
        body.contrast-bw .modal-title { color: #FFFF00 !important; }
        body.contrast-bw .modal-body pre { background-color: #1a1a1a !important; }
        body.contrast-bw #pageLinkInput { background-color: #111 !important; color: white !important; }
        body.contrast-bw .task-section, body.contrast-bw .ai-generator-section { background-color: black !important; border-color: #555 !important; }
        body.contrast-bw .bg-violet-50 { background-color: #111 !important; }
        body.contrast-bw .border-violet-300 { border-color: #555 !important; }
        body.contrast-bw .bg-violet-100 { background-color: #333 !important; }


        body.contrast-yb { background: #000000 !important; color: #FFFF00 !important; }
        body.contrast-yb header, body.contrast-yb .bg-white { background-color: #000000 !important; color: #FFFF00 !important; border-color: #FFFF00 !important; }
        body.contrast-yb [class*="text-gray-"], body.contrast-yb [class*="text-sky-"], body.contrast-yb [class*="text-violet-"] { color: #FFFF00 !important; }
        body.contrast-yb .text-sky-700, body.contrast-yb .text-sky-800, body.contrast-yb .text-sky-600, body.contrast-yb .text-violet-700 { color: #00FFFF !important; }
        body.contrast-yb a:not(.btn-gemini) { color: #00FFFF !important; text-decoration: underline !important; }
        body.contrast-yb button:not(#accessibilityBtn):not(.btn-gemini):not(.modal-close-btn):not(.copy-link-btn) { background-color: #1a1a1a !important; color: #FFFF00 !important; border-color: #FFFF00 !important; }
        body.contrast-yb .copy-link-btn { background-color: #1a1a1a !important; color: #FFFF00 !important; border-color: #FFFF00 !important; }
        body.contrast-yb .modal-content { background-color: black !important; color: #FFFF00 !important; border-color: #FFFF00 !important;}
        body.contrast-yb .modal-title { color: #00FFFF !important; }
        body.contrast-yb .modal-body pre { background-color: #1a1a1a !important; }
        body.contrast-yb #pageLinkInput { background-color: #111 !important; color: #FFFF00 !important; }
        body.contrast-yb .task-section, body.contrast-yb .ai-generator-section { background-color: black !important; border-color: #FFFF00 !important; }
        body.contrast-yb .bg-violet-50 { background-color: #111 !important; }
        body.contrast-yb .border-violet-300 { border-color: #FFFF00 !important; }
        body.contrast-yb .bg-violet-100 { background-color: #333 !important; }
    </style>
</head>
<body class="antialiased">
    <!-- Vlibra -->
    <div vw class="enabled">
        <div vw-access-button class="active"></div>
        <div vw-plugin-wrapper>
          <div class="vw-plugin-top-wrapper"></div>
        </div>
    </div>
    <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
    <script>
        new window.VLibras.Widget('https://vlibras.gov.br/app');
    </script>

    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-20">
                <div class="flex items-center">
                    <a href="/EJECT_Trilha_de_Conhecimento" class="text-2xl font-bold text-sky-700 hover:text-sky-800 transition-colors">
                        Hub de Conhecimentos
                    </a>
                </div>
                <div class="flex items-center space-x-2 sm:space-x-3">
                     <button id="exportTasksPdfBtn" title="Exportar Respostas das Tarefas" class="p-2 rounded-full text-sky-600 hover:bg-sky-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500 transition-colors">
                         <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                             <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                         </svg>
                     </button>
                     <button id="exportPdfBtn" title="Exportar Conte√∫do para PDF" class="p-2 rounded-full text-sky-600 hover:bg-sky-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500 transition-colors">
                         <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                             <path stroke-linecap="round" stroke-linejoin="round" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                         </svg>
                     </button>
                     <button id="sharePageBtn" title="Partilhar P√°gina" class="p-2 rounded-full text-sky-600 hover:bg-sky-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500 transition-colors">
                         <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                             <path stroke-linecap="round" stroke-linejoin="round" d="M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z" />
                         </svg>
                     </button>
                     <a href="https://www.ejectufrn.com.br/" target="_blank" rel="noopener noreferrer">
                         <img src="/EJECT_Trilha_de_Conhecimento/img/logo.svg" alt="Logotipo da EJECT" class="h-10">
                     </a>
                </div>
            </div>
        </nav>
    </header>

    <main id="content-container" class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <input type="hidden" id="trilha-nome" value="OKRs, KPIs e BPMN" />

        <section class="mb-6">
            <a href="/EJECT_Trilha_de_Conhecimento" class="inline-flex items-center bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg shadow transition duration-150 ease-in-out">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>
                Voltar
            </a>
        </section>

        <!-- Conte√∫do do OKRs, KPIs e BPMN -->
        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <h1 class="text-4xl font-bold text-sky-800 mb-4">OKRs, KPIs e BPMN</h1>
            <p class="text-lg leading-relaxed text-gray-700">Esta trilha visa fornecer diretrizes claras para a jornada de conhecimento dos membros da c√©lula da vice-presid√™ncia, com foco em OKRs (Objetivos e Resultados-Chave), KPIs (Indicadores-Chave de Desempenho) e BPMN (Modelagem de Processos de Neg√≥cio).</p>
        </section>

        <!-- Fundamentos do OKRs -->
        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-3xl font-semibold text-sky-700 mb-2 sm:mb-0">Introdu√ß√£o √†s OKRs</h2>
            </div>
            <div class="space-y-4 text-gray-700">
                <p>OKRs (Objectives and Key Results) s√£o metodologias de defini√ß√£o de metas usada por empresas para alinhar esfor√ßos e medir o progresso de forma clara e objetiva. Eles s√£o amplamente utilizados por empresas de tecnologia, como Google e LinkedIn, mas podem ser aplicados em qualquer setor ou contexto, incluindo empresas tradicionais, startups e at√© equipes pequenas.</p>
                <p>Para entender melhor, vamos dividir em duas partes:</p>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li>
                        <strong class="text-sky-700">Objective (Objetivo):</strong> O objetivo √© o <strong>que voc√™ quer alcan√ßar.</strong> Deve ser algo inspirador, claro e desafiador. Ele serve para motivar e engajar a equipe, proporcionando uma dire√ß√£o e um prop√≥sito claros. Um bom objetivo deve ser qualitativo e ambicioso, mas n√£o imposs√≠vel de ser alcan√ßado.
                        <p class="mt-2"><strong>Exemplo de Objetivo:</strong> Aumentar a satisfa√ß√£o do cliente com nossos produtos.</p>
                    </li>
                    <li>
                        <strong class="text-sky-700">Key Results (Resultados-chave):</strong> Os resultados-chave s√£o como voc√™ sabe que alcan√ßou o objetivo. Eles s√£o os indicadores quantitativos que medem o progresso em dire√ß√£o ao objetivo. Um bom resultado-chave deve ser espec√≠fico, mensur√°vel e ter um prazo claro.
                        <p class="mt-2">Para cada objetivo, voc√™ normalmente define de 2 a 5 resultados-chave. Eles devem ser metas desafiadoras, mas alcan√ß√°veis, e precisam estar ligados diretamente ao sucesso do objetivo.</p>
                        <p class="mt-2"><strong>Exemplo de Resultados-chave para o Objetivo acima:</strong></p>
                        <ul class="list-decimal list-inside ml-5 space-y-1 text-gray-700">
                            <li>Aumentar a pontua√ß√£o de satisfa√ß√£o do cliente de 7 para 9 no NPS (Net Promoter Score) at√© o final do trimestre.</li>
                            <li>Reduzir o tempo m√©dio de resposta do suporte ao cliente de 24 horas para 12 horas at√© o final do trimestre.</li>
                            <li>Aumentar a taxa de renova√ß√£o de contratos de 80% para 90% at√© o final do trimestre.</li>
                        </ul>
                    </li>
                </ul>
            </div>
        </section>
        
        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-3xl font-semibold text-sky-700 mb-2 sm:mb-0">Caracter√≠sticas principais dos OKRs</h2>
            </div>
            <div class="space-y-4 text-gray-700">
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li><strong class="text-sky-700">Transpar√™ncia:</strong> As OKRs s√£o p√∫blicos dentro da organiza√ß√£o. Todo mundo pode ver os OKRs de outras equipes ou indiv√≠duos, o que promove uma cultura de transpar√™ncia e colabora√ß√£o.</li>
                    <li><strong class="text-sky-700">Alinhamento:</strong> As OKRs s√£o ferramentas poderosas para alinhar os esfor√ßos de toda a organiza√ß√£o em dire√ß√£o a objetivos comuns. Cada equipe ou indiv√≠duo define seus OKRs, que devem estar alinhados com os OKRs de n√≠vel superior.</li>
                    <li><strong class="text-sky-700">Foco:</strong> As OKRs ajudam a manter o foco nas prioridades estrat√©gicas da organiza√ß√£o. Ao definir objetivos claros e resultados-chave mensur√°veis, as equipes sabem exatamente no que devem se concentrar para alcan√ßar o sucesso.</li>
                    <li><strong class="text-sky-700">Periodicidade:</strong> OKRs s√£o normalmente estabelecidos em ciclos trimestrais ou anuais, permitindo ajustes frequentes de acordo com o progresso e as mudan√ßas no ambiente.</li>
                </ul>
            </div>
        </section>

        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-3xl font-semibold text-sky-700 mb-2 sm:mb-0">Por que as OKRs funcionam?</h2>
            </div>
            <div class="space-y-4 text-gray-700">
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li><strong class="text-sky-700">Clareza:</strong> Todos sabem para onde a empresa est√° indo e o que precisam fazer para chegar l√°.</li>
                    <li><strong class="text-sky-700">Motiva√ß√£o:</strong> Objetivos inspiradores podem aumentar a motiva√ß√£o, j√° que as pessoas sabem que seu trabalho √© importante para alcan√ßar uma meta maior.</li>
                    <li><strong class="text-sky-700">Medi√ß√£o:</strong> Com resultados-chave mensur√°veis, fica claro se o progresso est√° sendo feito ou n√£o.</li>
                </ul>
            </div>
        </section>

        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-3xl font-semibold text-sky-700 mb-2 sm:mb-0">Diferen√ßa entre OKRs e Metas Tradicionais</h2>
            </div>
            <div class="space-y-4 text-gray-700">
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li>
                        <strong class="text-sky-700">Flexibilidade:</strong> Ao contr√°rio de metas anuais fixas, as OKRs podem ser ajustadas conforme necess√°rio a cada trimestre, acompanhando mudan√ßas nas prioridades da empresa.
                    </li>
                    <li>
                        <strong class="text-sky-700">Ambi√ß√£o:</strong> Enquanto metas tradicionais s√£o muitas vezes realistas, as OKRs incentivam objetivos desafiadores, levando as pessoas a se esfor√ßarem para mais.
                    </li>
                </ul>
                <div class="mt-4">
                    <h4 class="text-lg font-semibold text-sky-700 mb-2">Exemplo completo das OKRs:</h4>
                    <p><strong>Objetivo:</strong> Tornar nossa aplica√ß√£o m√≥vel a mais usada na categoria.</p>
                    <p class="mt-2"><strong>Resultados-chave:</strong></p>
                    <ul class="list-decimal list-inside ml-5 space-y-1 text-gray-700">
                        <li>Aumentar o n√∫mero de downloads di√°rios de 1.000 para 10.000 at√© o final do trimestre.</li>
                        <li>Aumentar a taxa de reten√ß√£o de usu√°rios de 30% para 50% at√© o final do trimestre.</li>
                        <li>Aumentar a pontua√ß√£o de avalia√ß√£o na App Store de 4,0 para 4,5 at√© o final do trimestre.</li>
                    </ul>
                </div>
            </div>
        </section>
        
        <section class="ai-generator-section mt-10 mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="p-6 border border-violet-300 rounded-xl bg-violet-50 shadow-inner">
                <h4 class="text-lg font-semibold text-violet-700 mb-3">‚ú® Gerador de OKRs com IA</h4>
                <p class="text-sm text-violet-600 mb-3">Descreva um objetivo que voc√™ quer atingir e clique no bot√£o para gerar exemplos de Resultados-Chave (KRs).</p>
                <div>
                    <label for="featureDescription" class="block text-sm font-medium text-violet-700 mb-1">Descri√ß√£o do Objetivo:</label>
                    <textarea id="featureDescription" rows="3" class="w-full p-2 border border-violet-300 rounded-md shadow-sm focus:ring-violet-500 focus:border-violet-500 text-gray-800" placeholder="Ex: Lan√ßar um novo produto no mercado"></textarea>
                </div>
                <button id="generateUserStoriesBtn" class="btn-gemini mt-4 w-full sm:w-auto">
                    Gerar Exemplos de Resultados-Chave
                </button>
                <div id="userStoriesLoading" class="loading-spinner-gemini hidden mt-4"></div>
            </div>
        </section>

        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="mt-6">
                <h3 class="text-lg font-semibold text-sky-700 mb-2">ProSEmpre 2023.1 | Capacita√ß√£o de Vice-presid√™ncia</h3>
                <div class="aspect-w-16 aspect-h-9 rounded-lg overflow-hidden shadow">
                    <iframe src="https://www.youtube.com/embed/R7MQC9M66Fk?si=YyECF4UTtCaMlAHP" title="ProSEmpre 2023.1 | Capacita√ß√£o de Vice-presid√™ncia" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
            </div>
        </section>

        <!-- Introdu√ß√£o √†s KPIs -->
        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-3xl font-semibold text-sky-700 mb-2 sm:mb-0">Introdu√ß√£o √†s KPIs</h2>
            </div>
            <div class="space-y-4 text-gray-700">
                <p>KPI (Key Performance Indicator), ou Indicador-chave de Desempenho, √© uma m√©trica utilizada para medir o desempenho de um processo, projeto ou iniciativa dentro de uma empresa. Os KPIs servem como uma forma objetiva de acompanhar se as atividades est√£o sendo realizadas de maneira eficaz e eficiente, ajudando a atingir as metas estabelecidas.</p>
                <p><strong>Caracter√≠sticas dos KPIs:</strong></p>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li><strong class="text-sky-700">Quantitativos:</strong> KPIs s√£o sempre mensur√°veis, com valores num√©ricos que permitem acompanhar o progresso ao longo do tempo.</li>
                    <li><strong class="text-sky-700">Relevantes:</strong> Eles devem estar diretamente relacionados aos objetivos estrat√©gicos da empresa ou equipe.</li>
                    <li><strong class="text-sky-700">Espec√≠ficos:</strong> Um bom KPI mede um aspecto muito claro e espec√≠fico de um processo.</li>
                    <li><strong class="text-sky-700">Acion√°veis:</strong> KPIs devem fornecer insights que levem √† a√ß√£o, ou seja, ajudar na tomada de decis√µes para melhorar o desempenho.</li>
                </ul>
            </div>
        </section>

        <section class="task-section mt-10 mb-10 p-6 bg-sky-50 rounded-xl shadow-lg text-gray-800 border border-sky-200">
            <h3 class="text-2xl font-semibold text-sky-700 mb-3 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-sky-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                </svg>
                Tarefa Pr√°tica: Identificando KPIs
            </h3>
            <p class="task-question text-gray-700 mb-4">Imagine que voc√™ √© o gerente de uma equipa de marketing digital. O objetivo da sua equipa √© "Aumentar a presen√ßa online da empresa". Cite tr√™s KPIs relevantes que poderiam ser usados para medir o sucesso desse objetivo e justifique por que cada um √© importante.</p>
            <textarea rows="5" class="task-answer w-full p-3 border border-sky-300 rounded-md shadow-sm focus:ring-2 focus:ring-sky-500 focus:border-sky-500 text-gray-800 placeholder-gray-400" placeholder="Ex: KPI 1: N√∫mero de seguidores nas redes sociais. Justificativa: Um aumento na base de seguidores indica um maior alcance da marca..."></textarea>
        </section>

        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-3xl font-semibold text-sky-700 mb-2 sm:mb-0">Tipos de KPIs</h2>
            </div>
            <div class="space-y-4 text-gray-700">
                <p>As KPIs podem variar de acordo com o objetivo da empresa ou setor, mas geralmente podem ser classificados em dois grandes grupos:</p>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li>
                        <strong class="text-sky-700">KPIs Operacionais:</strong> Medem o desempenho de processos do dia a dia e ajudam a garantir que as opera√ß√µes est√£o funcionando como esperado. S√£o usados com mais frequ√™ncia para o acompanhamento cont√≠nuo.
                        <p class="mt-2"><strong>Exemplo:</strong> Tempo m√©dio de produ√ß√£o de um produto, n√∫mero de chamadas atendidas por um operador de suporte, taxa de convers√£o de vendas.</p>
                    </li>
                    <li>
                        <strong class="text-sky-700">KPIs Estrat√©gicos:</strong> Medem o progresso em dire√ß√£o a metas de longo prazo e estrat√©gicas da organiza√ß√£o. Esses KPIs normalmente est√£o mais ligados ao crescimento ou √† sustentabilidade da empresa.
                        <p class="mt-2"><strong>Exemplo:</strong> Taxa de crescimento anual da receita, participa√ß√£o de mercado, satisfa√ß√£o geral do cliente.</p>
                    </li>
                </ul>
                <h4 class="text-lg font-semibold text-sky-700 mb-2 mt-6">Exemplos de KPIs em diferentes √°reas:</h4>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li>
                        <strong class="text-sky-700">Vendas:</strong> Receita gerada, N√∫mero de novos clientes adquiridos, Taxa de convers√£o de leads (potenciais clientes).
                    </li>
                    <li>
                        <strong class="text-sky-700">Marketing:</strong> Tr√°fego no site, Taxa de cliques (CTR) em campanhas de marketing digital, Custo por aquisi√ß√£o de cliente (CAC).
                    </li>
                    <li>
                        <strong class="text-sky-700">Recursos Humanos:</strong> Taxa de reten√ß√£o de funcion√°rios, Tempo m√©dio de contrata√ß√£o, Satisfa√ß√£o dos funcion√°rios (medida por pesquisas).
                    </li>
                </ul>
            </div>
        </section>

        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-3xl font-semibold text-sky-700 mb-2 sm:mb-0">Como escolher bons KPIs</h2>
            </div>
            <div class="space-y-4 text-gray-700">
                <p>Para definir KPIs eficazes, √© importante que elas:</p>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li><strong class="text-sky-700">Apoiem os objetivos estrat√©gicos:</strong> Devem estar diretamente relacionados ao que a empresa ou equipe quer alcan√ßar.</li>
                    <li><strong class="text-sky-700">Sejam mensur√°veis e espec√≠ficos:</strong> Devem ter uma f√≥rmula clara de medi√ß√£o, sem ambiguidade.</li>
                    <li><strong class="text-sky-700">Sejam alcan√ß√°veis, mas desafiadores:</strong> KPIs muito f√°ceis n√£o motivam a equipe, enquanto metas imposs√≠veis podem desmotivar.</li>
                    <li><strong class="text-sky-700">Tenham um per√≠odo definido para medi√ß√£o:</strong> KPIs precisam ser monitorados com regularidade, seja diariamente, semanalmente ou trimestralmente.</li>
                </ul>
                <div class="mt-4">
                    <h4 class="text-lg font-semibold text-sky-700 mb-2">Exemplo de KPI:</h4>
                    <p>Em uma empresa de com√©rcio eletr√¥nico, uma KPI pode ser o tempo de entrega dos produtos. Se a empresa tem o objetivo de melhorar a experi√™ncia do cliente, esse KPI ajudar√° a monitorar se as entregas est√£o acontecendo no prazo esperado.</p>
                    <ul class="list-disc list-inside ml-5 space-y-1 text-gray-700">
                        <li><strong class="text-sky-700">KPI: "Tempo m√©dio de entrega"</strong></li>
                        <li><strong class="text-sky-700">Objetivo:</strong> Reduzir o tempo de entrega de 5 para 3 dias.</li>
                        <li><strong class="text-sky-700">F√≥rmula:</strong> (Soma do tempo de entrega de todos os pedidos) √∑ (N√∫mero total de pedidos)</li>
                        <li><strong class="text-sky-700">Frequ√™ncia:</strong> Mensal</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-3xl font-semibold text-sky-700 mb-2 sm:mb-0">Diferen√ßa entre KPIs e OKRs</h2>
            </div>
            <p class="text-gray-700">Enquanto <strong>OKRs</strong> s√£o usadas para definir <strong>objetivos</strong> e medir o <strong>progresso</strong> em rela√ß√£o a esses objetivos, as <strong>KPIs</strong> s√£o m√©tricas que medem <strong>o desempenho cont√≠nuo de processos</strong>. As OKRs s√£o mais focados em metas de curto a m√©dio prazo e resultados desafiadores, enquanto as KPIs geralmente monitoram o desempenho de atividades regulares e operacionais.</p>
        </section>

        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="mt-6">
                <h3 class="text-lg font-semibold text-sky-700 mb-2">[Capacita√ß√£o] Indicadores</h3>
                <div class="aspect-w-16 aspect-h-9 rounded-lg overflow-hidden shadow">
                    <iframe src="https://www.youtube.com/embed/t2wpIGPYuOw?si=FuBMCMmDZveHMswo" title="[Capacita√ß√£o] Indicadores" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
            </div>
        </section>

        <!-- Introdu√ß√£o √†s BPMN -->
        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-3xl font-semibold text-sky-700 mb-2 sm:mb-0">Introdu√ß√£o √†s BPMN</h2>
            </div>
            <div class="space-y-4 text-gray-700">
                <p>BPMN (Business Process Model and Notation) √© uma nota√ß√£o gr√°fica padronizada utilizada para modelar processos de neg√≥cios. Sua principal fun√ß√£o √© representar visualmente o fluxo de atividades, tarefas e intera√ß√µes de um processo, facilitando o entendimento entre equipes t√©cnicas e n√£o t√©cnicas dentro de uma organiza√ß√£o.</p>
                <h4 class="text-lg font-semibold text-sky-700 mb-2 mt-4">Por que usar BPMN?</h4>
                <p>O BPMN √© amplamente utilizado porque:</p>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li><strong class="text-sky-700">Padroniza a comunica√ß√£o:</strong> Ele cria um modelo compreens√≠vel por todas as partes envolvidas (desenvolvedores, gerentes, stakeholders).</li>
                    <li><strong class="text-sky-700">Documenta processos:</strong> Ajuda a mapear, entender e melhorar os processos de neg√≥cio existentes.</li>
                    <li><strong class="text-sky-700">Simula e melhora processos:</strong> Ao visualizar o processo, √© poss√≠vel identificar gargalos, redund√¢ncias e oportunidades de melhoria.</li>
                </ul>
            </div>
        </section>

        <section class="task-section mt-10 mb-10 p-6 bg-sky-50 rounded-xl shadow-lg text-gray-800 border border-sky-200">
            <h3 class="text-2xl font-semibold text-sky-700 mb-3 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-sky-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
                Tarefa Pr√°tica: Modelando um Processo de Neg√≥cio
            </h3>
            <p class="task-question text-gray-700 mb-4">Descreva o processo de "Atendimento de um pedido de um cliente" para um e-commerce. Utilize os principais elementos do BPMN (Eventos, Atividades, Piscinas/Raias e Decis√µes) para explicar o fluxo, desde o momento em que o cliente finaliza a compra at√© o envio do produto.</p>
            <textarea rows="5" class="task-answer w-full p-3 border border-sky-300 rounded-md shadow-sm focus:ring-2 focus:ring-sky-500 focus:border-sky-500 text-gray-800 placeholder-gray-400" placeholder="Ex: O processo come√ßa com um Evento de In√≠cio 'Pedido Recebido'. A Atividade 'Verificar Estoque' √© realizada. Uma Decis√£o 'H√° produto em estoque?' determina se a pr√≥xima atividade √© 'Separar e Embalar' ou 'Notificar o cliente sobre atraso'..."></textarea>
        </section>
        
        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-3xl font-semibold text-sky-700 mb-2 sm:mb-0">Elementos principais do BPMN</h2>
            </div>
            <div class="space-y-4 text-gray-700">
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li><strong class="text-sky-700">Piscinas (Pools) e Raias (Lanes):</strong> Piscinas representam participantes (organiza√ß√µes, departamentos) e Raias subdividem uma piscina, indicando pap√©is ou responsabilidades.</li>
                    <li><strong class="text-sky-700">Eventos (Circulares):</strong> Evento de in√≠cio, intermedi√°rio e t√©rmino, que indicam o come√ßo, meio e fim de um processo.</li>
                    <li><strong class="text-sky-700">Atividades (Retangulares):</strong> Representam as tarefas ou atividades realizadas no processo.</li>
                    <li><strong class="text-sky-700">Decis√µes (Diamantes):</strong> Indicam pontos de decis√£o onde o fluxo pode seguir diferentes caminhos.</li>
                    <li><strong class="text-sky-700">Fluxos de Sequ√™ncia (Setas):</strong> Conectam os elementos, indicando a ordem das atividades.</li>
                    <li><strong class="text-sky-700">Conectores (Mensagens):</strong> Representam a comunica√ß√£o entre os participantes do processo.</li>
                    <li><strong class="text-sky-700">Artefatos:</strong> Elementos adicionais que fornecem informa√ß√µes sobre o processo (ex.: notas, grupos de tarefas).</li>
                </ul>
                <img src="https://www.researchgate.net/publication/363243490/figure/fig2/AS:11431281184863292@1693467674528/Figura-2-Categorias-e-elementos-utilizados-pela-notacao-BPMN.png" alt="Categorias e elementos utilizados pela nota√ß√£o BPMN" class="w-full max-w-lg mx-auto rounded-lg shadow mt-6">
            </div>
        </section>

        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-3xl font-semibold text-sky-700 mb-2 sm:mb-0">Exemplo de processo BPMN</h2>
            </div>
            <div class="space-y-4 text-gray-700">
                <p>Imagine que uma empresa tenha um processo de aprova√ß√£o de reembolso:</p>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li><strong class="text-sky-700">Evento de in√≠cio:</strong> Recebimento da solicita√ß√£o de reembolso.</li>
                    <li><strong class="text-sky-700">Atividade:</strong> Verifica√ß√£o dos documentos.</li>
                    <li><strong class="text-sky-700">Decis√£o:</strong> Aprovar ou rejeitar a solicita√ß√£o.</li>
                    <p class="ml-5">Se aprovado, vai para o departamento financeiro.</p>
                    <p class="ml-5">Se rejeitado, o processo termina com uma notifica√ß√£o ao funcion√°rio.</p>
                    <li><strong class="text-sky-700">Atividade:</strong> Processamento do reembolso.</li>
                    <li><strong class="text-sky-700">Evento de t√©rmino:</strong> Envio da confirma√ß√£o ao solicitante.</li>
                </ul>
            </div>
        </section>
        
        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-3xl font-semibold text-sky-700 mb-2 sm:mb-0">Vantagens do BPMN</h2>
            </div>
            <div class="space-y-4 text-gray-700">
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li><strong class="text-sky-700">Facilidade de entendimento:</strong> √â uma linguagem simples e visual que qualquer pessoa pode aprender rapidamente, independentemente de seu conhecimento t√©cnico.</li>
                    <li><strong class="text-sky-700">Melhoria de processos:</strong> Ao mapear visualmente, fica mais f√°cil ver inefici√™ncias e criar planos para otimizar o fluxo de trabalho.</li>
                    <li><strong class="text-sky-700">Integra√ß√£o com sistemas:</strong> Como √© um padr√£o amplamente aceito, o BPMN pode ser utilizado com v√°rias ferramentas de software para automatiza√ß√£o de processos.</li>
                </ul>
            </div>
        </section>

        <section class="mb-10 p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <div class="flex flex-col sm:flex-row justify-between sm:items-center mb-6 pb-4 border-b border-gray-200">
                <h2 class="text-3xl font-semibold text-sky-700 mb-2 sm:mb-0">Diferen√ßa entre BPMN e outros diagramas</h2>
            </div>
            <div class="space-y-4 text-gray-700">
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li>
                        <strong class="text-sky-700">Fluxogramas comuns:</strong> Embora ambos sejam usados para mapear processos, os fluxogramas s√£o mais simples e menos padronizados, o que pode gerar interpreta√ß√µes diferentes.
                    </li>
                    <li>
                        <strong class="text-sky-700">UML (Unified Modeling Language):</strong> Focado mais em modelagem de sistemas de software, enquanto o BPMN √© dedicado a processos de neg√≥cios.
                    </li>
                </ul>
            </div>
        </section>

        <section class="p-6 bg-white rounded-xl shadow-lg text-gray-800">
            <h2 class="text-3xl font-semibold text-sky-700 mb-6 pb-4 border-b border-gray-200">Refer√™ncias e Conte√∫dos Extras</h2>
            <div class="space-y-6">
                <div>
                    <h3 class="text-xl font-semibold text-sky-600 mb-3">Material de Suporte</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li><a href="https://drive.google.com/file/d/1ppL3ktTOuepeI4NL4-XawKWW8VHxqNlU/view?usp=sharing" target="_blank" class="text-sky-600 hover:text-sky-800 hover:underline transition-colors">Material de suporte 1 - Modelagem de Processos BPMN 2</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-sky-600 mb-3">Cursos</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li><a href="https://www.fm2s.com.br/cursos/yellow-belt" target="_blank" class="text-sky-600 hover:text-sky-800 hover:underline transition-colors">Yellow Belt: agilidade em seu projeto (FM2S)</a></li>
                        <li><a href="https://www.udemy.com/course/formacao-total-em-scrum/?couponCode=LETSLEARNNOW" target="_blank" class="text-sky-600 hover:text-sky-800 hover:underline transition-colors">Introdu√ß√£o √†s OKRs - Tudo o que voc√™ precisa saber sobre OKRs (Udemy)</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-semibold text-sky-600 mb-3">Artigos</h3>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li><a href="https://www.rockcontent.com/blog/okr/" target="_blank" class="text-sky-600 hover:text-sky-800 hover:underline transition-colors">OKR: o que √©, como funciona e como implementar na sua empresa (Rock Content)</a></li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-sky-900 text-white text-center py-8 mt-12">
        <p class="text-sm">Feito com <strong class="font-semibold">foco</strong> e <strong class="font-semibold">compromisso</strong> pela EJECT¬© - Todos os direitos reservados.</p>
    </footer>

    <div id="geminiModal" class="modal-backdrop">
        <div class="modal-content">
            <div class="modal-header">
                <h5 id="geminiModalTitle" class="modal-title">Resultado da IA</h5>
                <button type="button" class="modal-close-btn" id="geminiModalCloseBtn">√ó</button>
            </div>
            <div id="geminiModalBody" class="modal-body"></div>
        </div>
    </div>

    <div id="shareModal" class="modal-backdrop">
        <div class="modal-content">
            <div class="modal-header">
                <h5 id="shareModalTitle" class="modal-title">Compartilhar P√°gina</h5>
                <button type="button" class="modal-close-btn" id="shareModalCloseBtn">√ó</button>
            </div>
            <div id="shareModalBody" class="modal-body text-center">
                <p class="mb-2 text-sm text-gray-600">Copie o link ou utilize o QR Code:</p>
                <div class="flex items-center border border-gray-300 rounded-md p-2 mb-4">
                    <input type="text" id="pageLinkInput" readonly class="w-full p-1.5 border-none focus:ring-0 text-sm text-gray-700 bg-gray-50 rounded-l-md">
                    <button id="copyLinkBtn" class="copy-link-btn px-4 py-1.5 rounded-r-md text-sm font-medium transition-colors">
                        Copiar
                    </button>
                </div>
                <div id="qrcodeCanvasContainer" class="flex justify-center">
                    <div id="qrcodeCanvas"></div>
                </div>
                <p id="copyFeedback" class="text-xs text-green-600 mt-2 h-4"></p>
            </div>
        </div>
    </div>
    <div id="pdfExportFeedback" class="pdf-feedback"></div>

    <div id="accessibilityToolbar">
        <button id="accessibilityBtn" title="Op√ß√µes de Acessibilidade">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2zm9 7h-5v12c0 .55-.45 1-1 1s-1-.45-1-1v-5h-2v5c0 .55-.45 1-1 1s-1-.45-1-1V9H3V7h18v2z"/>
            </svg>
        </button>
        <div id="accessibilityPanel" class="hidden">
            <div class="accessibility-section">
                <h4>Tamanho da Fonte</h4>
                <div class="accessibility-controls space-y-1">
                    <button id="increaseFontBtn">Aumentar Fonte (+)</button>
                    <button id="decreaseFontBtn">Diminuir Fonte (-)</button>
                    <button id="resetFontBtn">Restaurar Fonte</button>
                </div>
            </div>
            <div class="accessibility-section">
                <h4>Contraste</h4>
                <div class="accessibility-controls space-y-1">
                    <button id="defaultContrastBtn">Padr√£o</button>
                    <button id="bwContrastBtn">Preto e Branco</button>
                    <button id="ybContrastBtn">Amarelo e Preto</button>
                </div>
            </div>
            <div class="accessibility-section">
                <h4>Leitor de Texto</h4>
                <div class="accessibility-controls tts-controls flex space-x-1">
                    <button id="playTTSBtn" title="Ler Conte√∫do">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z" clip-rule="evenodd" /></svg>
                        Ler
                    </button>
                    <button id="pauseTTSBtn" title="Pausar Leitura">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h1a1 1 0 001-1V8a1 1 0 00-1-1H8zm3 0a1 1 0 00-1 1v4a1 1 0 001 1h1a1 1 0 001-1V8a1 1 0 00-1-1h-1z" clip-rule="evenodd" /></svg>
                        Pausar
                    </button>
                    <button id="stopTTSBtn" title="Parar Leitura">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8 9a1 1 0 00-1 1v1a1 1 0 102 0v-1a1 1 0 00-1-1zm4 0a1 1 0 00-1 1v1a1 1 0 102 0v-1a1 1 0 00-1-1z" clip-rule="evenodd" /></svg>
                        Parar
                    </button>
                </div>
                <div class="accessibility-controls mt-2">
                    <label for="ttsVoiceSelect">Voz:</label>
                    <select id="ttsVoiceSelect" disabled><option value="">A carregar vozes...</option></select>
                </div>
                <div class="accessibility-controls mt-1">
                    <label for="ttsRateRange">Velocidade: <span id="ttsRateValue">1</span></label>
                    <input type="range" id="ttsRateRange" min="0.5" max="2" step="0.1" value="1">
                </div>
                <div class="accessibility-controls mt-1">
                    <label for="ttsPitchRange">Tom: <span id="ttsPitchValue">1</span></label>
                    <input type="range" id="ttsPitchRange" min="0" max="2" step="0.1" value="1">
                </div>
            </div>
        </div>
    </div>

    <script>
        // Assegurar que o objeto jsPDF est√° dispon√≠vel globalmente se usar a vers√£o UMD
        const { jsPDF } = window.jspdf;

        // --- Gemini API Integration ---
        const generateUserStoriesBtn = document.getElementById('generateUserStoriesBtn');
        const featureDescriptionTextarea = document.getElementById('featureDescription');
        const userStoriesLoadingDiv = document.getElementById('userStoriesLoading');
        const geminiModal = document.getElementById('geminiModal');
        const geminiModalTitle = document.getElementById('geminiModalTitle');
        const geminiModalBody = document.getElementById('geminiModalBody');
        const geminiModalCloseBtn = document.getElementById('geminiModalCloseBtn');

        function showGeminiModal(title, htmlContent) {
            if (geminiModalTitle) geminiModalTitle.textContent = title;
            if (geminiModalBody) geminiModalBody.innerHTML = htmlContent;
            if (geminiModal) geminiModal.classList.add('active');
        }
        function hideGeminiModal() {
            if (geminiModal) geminiModal.classList.remove('active');
        }
        if (geminiModalCloseBtn) geminiModalCloseBtn.addEventListener('click', hideGeminiModal);
        if (geminiModal) geminiModal.addEventListener('click', function(event) {
            if (event.target === geminiModal) hideGeminiModal();
        });

        if (generateUserStoriesBtn) {
            generateUserStoriesBtn.addEventListener('click', async () => {
                const description = featureDescriptionTextarea.value.trim();
                if (!description) {
                    showGeminiModal("Erro de Valida√ß√£o", "<p>Por favor, descreva uma funcionalidade para gerar os KRs.</p>");
                    return;
                }
                userStoriesLoadingDiv.classList.remove('hidden');
                generateUserStoriesBtn.disabled = true;
                const prompt = `Com base no seguinte objetivo, gere 3 exemplos de Resultados-Chave (KRs) mensur√°veis no formato "Aumentar [m√©trica] de [valor inicial] para [valor final] at√© [data]". N√£o adicione introdu√ß√µes ou conclus√µes, apenas os KRs. Objetivo: "${description}"`;
                let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                const payload = { contents: chatHistory };
                const apiKey = "AIzaSyAnojN8ZpEjiHaUVlZbgdalGVKdJwkIrRI";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`Erro da API: ${response.status} ${response.statusText}. Detalhes: ${errorData?.error?.message || 'Sem detalhes adicionais.'}`);
                    }
                    const result = await response.json();
                    if (result.candidates && result.candidates[0]?.content?.parts?.[0]) {
                        const text = result.candidates[0].content.parts[0].text;
                        const formattedText = text.split('\n').map(line => line.trim()).filter(line => line.length > 0).map(line => `<p class="mb-2 p-2 bg-violet-100 rounded">${line}</p>`).join('');
                        showGeminiModal("‚ú® Exemplos de Resultados-Chave Gerados", `<div class="text-sm">${formattedText || '<p>N√£o foi poss√≠vel gerar os KRs.</p>'}</div>`);
                    } else {
                        showGeminiModal("Erro", "<p>N√£o foi poss√≠vel extrair os KRs da resposta da API.</p>");
                    }
                } catch (error) {
                    showGeminiModal("Erro na API", `<p>Ocorreu um erro: ${error.message}</p>`);
                } finally {
                    userStoriesLoadingDiv.classList.add('hidden');
                    generateUserStoriesBtn.disabled = false;
                }
            });
        }

        // --- Share Page Functionality ---
        const sharePageBtn = document.getElementById('sharePageBtn');
        const shareModal = document.getElementById('shareModal');
        const shareModalCloseBtn = document.getElementById('shareModalCloseBtn');
        const pageLinkInput = document.getElementById('pageLinkInput');
        const copyLinkBtn = document.getElementById('copyLinkBtn');
        const qrcodeCanvas = document.getElementById('qrcodeCanvas');
        const copyFeedback = document.getElementById('copyFeedback');
        let qrCodeInstance = null;

        function showShareModal() {
            if (shareModal && pageLinkInput && qrcodeCanvas) {
                const pageUrl = window.location.href;
                pageLinkInput.value = pageUrl;
                qrcodeCanvas.innerHTML = '';
                if (typeof QRCode !== 'undefined') {
                     qrCodeInstance = new QRCode(qrcodeCanvas, {
                         text: pageUrl, width: 180, height: 180,
                         colorDark : "#000000", colorLight : "#ffffff",
                         correctLevel : QRCode.CorrectLevel.H
                     });
                } else {
                    qrcodeCanvas.innerHTML = '<p class="text-xs text-red-500">Erro ao carregar biblioteca QRCode.</p>';
                }
                shareModal.classList.add('active');
            }
        }
        function hideShareModal() {
            if (shareModal) {
                shareModal.classList.remove('active');
                if (copyFeedback) copyFeedback.textContent = '';
            }
        }
        if (sharePageBtn) sharePageBtn.addEventListener('click', showShareModal);
        if (shareModalCloseBtn) shareModalCloseBtn.addEventListener('click', hideShareModal);
        if (shareModal) shareModal.addEventListener('click', (event) => {
            if (event.target === shareModal) hideShareModal();
        });
        if (copyLinkBtn && pageLinkInput) {
            copyLinkBtn.addEventListener('click', () => {
                pageLinkInput.select();
                pageLinkInput.setSelectionRange(0, 99999);
                try {
                    document.execCommand('copy');
                    if(copyFeedback) {
                        copyFeedback.textContent = 'Link copiado!';
                        copyFeedback.classList.remove('text-red-500');
                        copyFeedback.classList.add('text-green-600');
                    }
                    setTimeout(() => { if(copyFeedback) copyFeedback.textContent = ''; }, 2000);
                } catch (err) {
                    if(copyFeedback) {
                        copyFeedback.textContent = 'Erro ao copiar.';
                        copyFeedback.classList.remove('text-green-600');
                        copyFeedback.classList.add('text-red-500');
                    }
                }
            });
        }

        // --- PDF Export Functionality ---
        const exportPdfBtn = document.getElementById('exportPdfBtn');
        const exportTasksPdfBtn = document.getElementById('exportTasksPdfBtn');
        const pdfExportFeedbackEl = document.getElementById('pdfExportFeedback');

        function showPdfFeedback(message, isError = false) {
            if (pdfExportFeedbackEl) {
                pdfExportFeedbackEl.textContent = message;
                pdfExportFeedbackEl.className = 'pdf-feedback';
                if (isError) {
                    pdfExportFeedbackEl.classList.add('error');
                } else {
                    pdfExportFeedbackEl.classList.add('success');
                }
                pdfExportFeedbackEl.style.display = 'block';
                setTimeout(() => {
                    pdfExportFeedbackEl.style.display = 'none';
                }, 3000);
            }
        }

        if (exportPdfBtn) {
            exportPdfBtn.addEventListener('click', async () => {
                const originalContentElement = document.getElementById('content-container');
                if (!originalContentElement) {
                    showPdfFeedback("Elemento de conte√∫do principal n√£o encontrado.", true);
                    return;
                }
                showPdfFeedback("A preparar PDF do conte√∫do, por favor aguarde...");
                exportPdfBtn.disabled = true;

                const clonedContent = originalContentElement.cloneNode(true);
                // Remover se√ß√µes de tarefa e o gerador de user stories para o PDF
                clonedContent.querySelectorAll('.task-section, .ai-generator-section').forEach(el => el.remove());

                clonedContent.style.position = 'absolute';
                clonedContent.style.left = '-9999px';
                clonedContent.style.width = originalContentElement.offsetWidth + 'px';
                clonedContent.style.backgroundColor = 'white';
                clonedContent.style.padding = '20px';
                clonedContent.style.color = '#1f2937';

                clonedContent.querySelectorAll('p, h1, h2, h3, h4, h5, h6, li, strong, span, div:not([class*="bg-"])')
                    .forEach(el => el.style.color = '#1f2937');

                document.body.appendChild(clonedContent);
                try {
                    const canvas = await html2canvas(clonedContent, {
                        scale: 2, useCORS: true, logging: false, backgroundColor: null,
                        width: clonedContent.scrollWidth, height: clonedContent.scrollHeight,
                        windowWidth: clonedContent.scrollWidth, windowHeight: clonedContent.scrollHeight
                    });
                    document.body.removeChild(clonedContent);
                    const imgData = canvas.toDataURL('image/png');
                    const pdf = new jsPDF({ orientation: 'p', unit: 'mm', format: 'a4' });
                    const imgProps = pdf.getImageProperties(imgData);
                    const pdfPageWidth = pdf.internal.pageSize.getWidth();
                    const pdfPageHeight = pdf.internal.pageSize.getHeight();
                    const margin = 10;
                    const usablePdfWidth = pdfPageWidth - (2 * margin);
                    const usablePdfHeight = pdfPageHeight - (2 * margin);
                    const imgRenderHeight = (imgProps.height * usablePdfWidth) / imgProps.width;
                    let heightLeft = imgRenderHeight;
                    let currentYPosition = margin;
                    pdf.addImage(imgData, 'PNG', margin, currentYPosition, usablePdfWidth, imgRenderHeight);
                    heightLeft -= usablePdfHeight;
                    while (heightLeft > 0) {
                        currentYPosition -= usablePdfHeight;
                        pdf.addPage();
                        pdf.addImage(imgData, 'PNG', margin, currentYPosition, usablePdfWidth, imgRenderHeight);
                        heightLeft -= usablePdfHeight;
                    }
                    pdf.save('okrs_kpis_bpmn_conteudo.pdf');
                    showPdfFeedback("PDF do conte√∫do gerado com sucesso!");
                } catch (error) {
                    console.error("Erro ao gerar PDF do conte√∫do:", error);
                    showPdfFeedback("Erro ao gerar PDF do conte√∫do. Verifique a consola.", true);
                    if (document.body.contains(clonedContent)) {
                        document.body.removeChild(clonedContent);
                    }
                } finally {
                    exportPdfBtn.disabled = false;
                }
            });
        }

        // Exportar Respostas das Tarefas para PDF
        if (exportTasksPdfBtn) {
            exportTasksPdfBtn.addEventListener('click', () => {
                const taskSections = document.querySelectorAll('.task-section');
                if (taskSections.length === 0) {
                    showPdfFeedback("Nenhuma tarefa encontrada na p√°gina.", true);
                    return;
                }

                showPdfFeedback("A preparar PDF das respostas, por favor aguarde...");
                exportTasksPdfBtn.disabled = true;

                const pdf = new jsPDF({ orientation: 'p', unit: 'mm', format: 'a4' });
                const margin = 15;
                const usableWidth = pdf.internal.pageSize.getWidth() - 2 * margin;
                let currentY = margin;
                const lineSpacing = 7; // Espa√ßo entre linhas de texto
                const taskSpacing = 15; // Espa√ßo entre tarefas

                pdf.setFontSize(18);
                pdf.text("Respostas das Tarefas Pr√°ticas - OKRs, KPIs e BPMN", margin, currentY);
                currentY += lineSpacing * 2;

                taskSections.forEach((section, index) => {
                    if (currentY > (pdf.internal.pageSize.getHeight() - margin * 3)) { // Verifica espa√ßo para nova tarefa
                        pdf.addPage();
                        currentY = margin;
                    }

                    const titleElement = section.querySelector('h3');
                    const questionElement = section.querySelector('.task-question');
                    const answerElement = section.querySelector('.task-answer');

                    if (titleElement) {
                        pdf.setFontSize(14);
                        pdf.setTextColor(52, 73, 94); // Cor escura para o t√≠tulo da tarefa
                        const titleLines = pdf.splitTextToSize(titleElement.textContent.trim().replace('Tarefa Pr√°tica: ', ''), usableWidth);
                        pdf.text(titleLines, margin, currentY);
                        currentY += (titleLines.length * lineSpacing * 0.8);
                    }

                    if (questionElement) {
                        pdf.setFontSize(10);
                        pdf.setTextColor(100, 100, 100); // Cinza para a pergunta
                        const questionLines = pdf.splitTextToSize("Pergunta: " + questionElement.textContent.trim(), usableWidth);
                        pdf.text(questionLines, margin, currentY);
                        currentY += (questionLines.length * lineSpacing * 0.7);
                    }

                    if (answerElement) {
                        pdf.setFontSize(11);
                        pdf.setTextColor(0, 0, 0); // Preto para a resposta
                        const answerText = answerElement.value.trim() || "Nenhuma resposta fornecida.";
                        const answerLines = pdf.splitTextToSize("Resposta: \n" + answerText, usableWidth);

                        if (currentY + (answerLines.length * lineSpacing * 0.7) > (pdf.internal.pageSize.getHeight() - margin)) {
                            pdf.addPage();
                            currentY = margin;
                        }
                        pdf.text(answerLines, margin, currentY);
                        currentY += (answerLines.length * lineSpacing * 0.7);
                    }

                    currentY += taskSpacing; // Espa√ßo antes da pr√≥xima tarefa
                     if (index < taskSections.length - 1) {
                         pdf.setDrawColor(200, 200, 200); // Linha divis√≥ria suave
                         pdf.line(margin, currentY - (taskSpacing / 2), pdf.internal.pageSize.getWidth() - margin, currentY - (taskSpacing / 2));
                     }
                });

                try {
                    pdf.save('respostas_tarefas_okrs_kpis_bpmn.pdf');
                    showPdfFeedback("PDF das respostas gerado com sucesso!");
                } catch(e) {
                    console.error("Erro ao salvar PDF das tarefas:", e);
                    showPdfFeedback("Erro ao salvar PDF das tarefas.", true);
                } finally {
                    exportTasksPdfBtn.disabled = false;
                }
            });
        }

        // --- Accessibility Features ---
        const accessibilityBtn = document.getElementById('accessibilityBtn');
        const accessibilityPanel = document.getElementById('accessibilityPanel');
        const mainContentContainer = document.getElementById('content-container');

        const increaseFontBtn = document.getElementById('increaseFontBtn');
        const decreaseFontBtn = document.getElementById('decreaseFontBtn');
        const resetFontBtn = document.getElementById('resetFontBtn');

        const defaultContrastBtn = document.getElementById('defaultContrastBtn');
        const bwContrastBtn = document.getElementById('bwContrastBtn');
        const ybContrastBtn = document.getElementById('ybContrastBtn');

        const playTTSBtn = document.getElementById('playTTSBtn');
        const pauseTTSBtn = document.getElementById('pauseTTSBtn');
        const stopTTSBtn = document.getElementById('stopTTSBtn');
        const ttsVoiceSelect = document.getElementById('ttsVoiceSelect');
        const ttsRateRange = document.getElementById('ttsRateRange');
        const ttsRateValue = document.getElementById('ttsRateValue');
        const ttsPitchRange = document.getElementById('ttsPitchRange');
        const ttsPitchValue = document.getElementById('ttsPitchValue');


        let currentFontSizeMultiplier = 1;
        const FONT_SIZE_STEP_ACC = 0.1;
        const MIN_FONT_MULTIPLIER_ACC = 0.7;
        const MAX_FONT_MULTIPLIER_ACC = 1.8;
        let originalFontSizesMap = new Map();

        if (accessibilityBtn && accessibilityPanel) {
            accessibilityBtn.addEventListener('click', () => {
                accessibilityPanel.classList.toggle('active');
                accessibilityPanel.classList.toggle('hidden');
            });
        }

        function storeOriginalFontSizesAcc() {
            if (originalFontSizesMap.size === 0 && mainContentContainer) {
                 mainContentContainer.querySelectorAll('p, h1, h2, h3, h4, h5, h6, li, a, strong, span:not([class*="icon"])').forEach((el, index) => {
                    const computedStyle = window.getComputedStyle(el);
                    const elId = el.dataset.accId || `acc-el-${index}`;
                    el.dataset.accId = elId;
                    originalFontSizesMap.set(elId, parseFloat(computedStyle.fontSize));
                });
            }
        }

        function updateFontSizesAcc(multiplier) {
            if (!mainContentContainer) return;
            storeOriginalFontSizesAcc();

            currentFontSizeMultiplier = Math.max(MIN_FONT_MULTIPLIER_ACC, Math.min(multiplier, MAX_FONT_MULTIPLIER_ACC));

            mainContentContainer.querySelectorAll('[data-acc-id]').forEach(el => {
                const originalSize = originalFontSizesMap.get(el.dataset.accId);
                if (originalSize) {
                    el.style.fontSize = (originalSize * currentFontSizeMultiplier) + 'px';
                }
            });

            mainContentContainer.querySelectorAll('p, li').forEach(el => {
                 const currentElementFontSize = parseFloat(el.style.fontSize || window.getComputedStyle(el).fontSize);
                 let newLineHeight = originalFontSizesMap.get(el.dataset.accId) * 1.7;
                 if (currentFontSizeMultiplier !== 1) {
                     newLineHeight = (originalFontSizesMap.get(el.dataset.accId) * 1.7 * currentFontSizeMultiplier * 0.9);
                 }
                 el.style.lineHeight = Math.max(originalFontSizesMap.get(el.dataset.accId) * 1.5, newLineHeight) + 'px';
            });
        }


        if (increaseFontBtn) {
            increaseFontBtn.addEventListener('click', () => {
                updateFontSizesAcc(currentFontSizeMultiplier + FONT_SIZE_STEP_ACC);
            });
        }
        if (decreaseFontBtn) {
            decreaseFontBtn.addEventListener('click', () => {
                updateFontSizesAcc(currentFontSizeMultiplier - FONT_SIZE_STEP_ACC);
            });
        }
        if (resetFontBtn) {
            resetFontBtn.addEventListener('click', () => {
                currentFontSizeMultiplier = 1;
                mainContentContainer.querySelectorAll('[data-acc-id]').forEach(el => {
                    const originalSize = originalFontSizesMap.get(el.dataset.accId);
                    if (originalSize) {
                        el.style.fontSize = originalSize + 'px';
                        if (el.tagName === 'P' || el.tagName === 'LI') {
                           el.style.lineHeight = (originalSize * 1.7) + 'px';
                        }
                    } else {
                           el.style.fontSize = '';
                           if (el.tagName === 'P' || el.tagName === 'LI') {
                               el.style.lineHeight = '';
                           }
                    }
                });
            });
        }

        function applyContrast(themeClass) {
            document.body.classList.remove('contrast-default', 'contrast-bw', 'contrast-yb');
            if (themeClass !== 'contrast-default') {
                document.body.classList.add(themeClass);
            }
        }
        if (defaultContrastBtn) defaultContrastBtn.addEventListener('click', () => applyContrast('contrast-default'));
        if (bwContrastBtn) bwContrastBtn.addEventListener('click', () => applyContrast('contrast-bw'));
        if (ybContrastBtn) ybContrastBtn.addEventListener('click', () => applyContrast('contrast-yb'));

        let speechSynth = window.speechSynthesis;
        let currentUtterance = null;
        let elementsToRead = [];
        let currentElementIndex = 0;
        let isReadingPaused = false;
        let availableVoices = [];

        function populateVoiceList() {
            if(typeof speechSynthesis === 'undefined' || !ttsVoiceSelect) {
                return;
            }
            availableVoices = speechSynth.getVoices();
            ttsVoiceSelect.innerHTML = '';

            if (availableVoices.length === 0) {
                 ttsVoiceSelect.innerHTML = '<option value="">Nenhuma voz dispon√≠vel</option>';
                 ttsVoiceSelect.disabled = true;
                 return;
            }

            let hasPortugueseVoice = false;
            availableVoices.forEach(voice => {
                if (voice.lang.startsWith('pt')) {
                    const option = document.createElement('option');
                    option.textContent = `${voice.name} (${voice.lang})`;
                    option.setAttribute('data-lang', voice.lang);
                    option.setAttribute('data-name', voice.name);
                    ttsVoiceSelect.appendChild(option);
                    hasPortugueseVoice = true;
                }
            });

            if (!hasPortugueseVoice) {
                 availableVoices.forEach(voice => {
                    const option = document.createElement('option');
                    option.textContent = `${voice.name} (${voice.lang})`;
                    option.setAttribute('data-lang', voice.lang);
                    option.setAttribute('data-name', voice.name);
                    ttsVoiceSelect.appendChild(option);
                });
            }
            ttsVoiceSelect.disabled = false;
        }

        populateVoiceList();
        if (typeof speechSynthesis !== 'undefined' && speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = populateVoiceList;
        }


        function prepareTextToRead() {
            if (!mainContentContainer) return '';
            let textSegments = [];
            const sections = mainContentContainer.querySelectorAll('section:not(.task-section)');
            
            sections.forEach(section => {
                const titleElement = section.querySelector('h1, h2');
                if (titleElement && titleElement.textContent.trim().length > 0) {
                    textSegments.push(titleElement.textContent.trim() + ".");
                }
                section.querySelectorAll('p, h3, h4, li').forEach(el => {
                    if (el.closest('.ai-generator-section') && !el.matches('h4, p')) {
                        return; // Exclui elementos dentro do gerador de user stories, exceto o t√≠tulo e a descri√ß√£o.
                    }
                    if (el.closest('ul.list-disc li a') && el.closest('ul.list-disc li')) {
                        textSegments.push(el.textContent.trim().replace(/\s+/g, ' ') + ".");
                        return;
                    }
                    
                    if (el.textContent.trim().length > 0) {
                        textSegments.push(el.textContent.trim().replace(/\s+/g, ' ') + ".");
                    }
                });
            });
            return textSegments.join(' \n ');
        }


        function speakNextSegment() {
            if (currentElementIndex >= elementsToRead.length || !speechSynth) {
                playTTSBtn.disabled = false;
                pauseTTSBtn.disabled = true;
                stopTTSBtn.disabled = true;
                currentElementIndex = 0;
                currentUtterance = null;
                elementsToRead = [];
                return;
            }
            if (speechSynth.paused && isReadingPaused) { return; }
            if (speechSynth.speaking && !isReadingPaused) { return; }

            currentUtterance = new SpeechSynthesisUtterance(elementsToRead[currentElementIndex]);
            currentUtterance.lang = 'pt-BR';
            currentUtterance.rate = parseFloat(ttsRateRange.value) || 1;
            currentUtterance.pitch = parseFloat(ttsPitchRange.value) || 1;

            const selectedVoiceName = ttsVoiceSelect.selectedOptions[0]?.getAttribute('data-name');
            if (selectedVoiceName) {
                const voice = availableVoices.find(v => v.name === selectedVoiceName);
                if (voice) currentUtterance.voice = voice;
            } else {
                 const portugueseVoice = availableVoices.find(v => v.lang.startsWith('pt-BR') || v.lang.startsWith('pt-PT'));
                 if(portugueseVoice) currentUtterance.voice = portugueseVoice;
            }

            currentUtterance.onend = () => {
                if (elementsToRead.length === 0) return;

                if (currentElementIndex < elementsToRead.length - 1) {
                    currentElementIndex++;
                    speakNextSegment();
                } else {
                    playTTSBtn.disabled = false;
                    pauseTTSBtn.disabled = true;
                    stopTTSBtn.disabled = true;
                    currentElementIndex = 0;
                    currentUtterance = null;
                    elementsToRead = [];
                }
            };
            currentUtterance.onerror = (event) => {
                console.error('Erro na s√≠ntese de voz:', event.error);
                isReadingPaused = false;
                currentElementIndex = 0;
                elementsToRead = [];
                currentUtterance = null;
                if (speechSynth) { speechSynth.cancel(); }
                playTTSBtn.disabled = false;
                pauseTTSBtn.disabled = true;
                stopTTSBtn.disabled = true;
            };
            speechSynth.speak(currentUtterance);
            playTTSBtn.disabled = true;
            pauseTTSBtn.disabled = false;
            stopTTSBtn.disabled = false;
            isReadingPaused = false;
        }

        if (playTTSBtn) {
            playTTSBtn.addEventListener('click', () => {
                if (!speechSynth) {
                    showGeminiModal("Erro de Acessibilidade", "<p>A s√≠ntese de voz n√£o √© suportada neste navegador.</p>");
                    return;
                }
                if (speechSynth.paused && currentUtterance && isReadingPaused) {
                    speechSynth.resume();
                    isReadingPaused = false;
                    playTTSBtn.disabled = true;
                    pauseTTSBtn.disabled = false;
                    stopTTSBtn.disabled = false;
                } else {
                    speechSynth.cancel();
                    currentUtterance = null;
                    isReadingPaused = false;
                    elementsToRead = [];
                    currentElementIndex = 0;

                    const fullText = prepareTextToRead();
                    elementsToRead = fullText.split('. ')
                                             .map(s => s.trim())
                                             .filter(segment => segment.length > 0)
                                             .map(s => s.endsWith('.') ? s : s + '.');

                    if (elementsToRead.length > 0) {
                        speakNextSegment();
                    } else {
                        showGeminiModal("Erro de Acessibilidade", "<p>N√£o h√° conte√∫do textual para ler na p√°gina.</p>");
                        playTTSBtn.disabled = false;
                        pauseTTSBtn.disabled = true;
                        stopTTSBtn.disabled = true;
                    }
                }
            });
        }

        if (pauseTTSBtn) {
            pauseTTSBtn.addEventListener('click', () => {
                if (speechSynth && speechSynth.speaking && !speechSynth.paused) {
                    speechSynth.pause();
                    isReadingPaused = true;
                    playTTSBtn.disabled = false;
                    pauseTTSBtn.disabled = true;
                }
            });
            pauseTTSBtn.disabled = true;
        }

        if (stopTTSBtn) {
            stopTTSBtn.addEventListener('click', () => {
                isReadingPaused = false;
                currentElementIndex = 0;
                elementsToRead = [];
                currentUtterance = null;
                if (speechSynth) { speechSynth.cancel(); }
                playTTSBtn.disabled = false;
                pauseTTSBtn.disabled = true;
                stopTTSBtn.disabled = true;
            });
            stopTTSBtn.disabled = true;
        }

        if (ttsRateRange && ttsRateValue) {
            ttsRateRange.addEventListener('input', () => {
                ttsRateValue.textContent = ttsRateRange.value;
                if (currentUtterance && speechSynth.speaking && !speechSynth.paused) {
                    speechSynth.cancel();
                    currentUtterance.rate = parseFloat(ttsRateRange.value);
                    speechSynth.speak(currentUtterance);
                } else if (currentUtterance && speechSynth.paused && isReadingPaused) {
                     currentUtterance.rate = parseFloat(ttsRateRange.value);
                }
            });
        }
        if (ttsPitchRange && ttsPitchValue) {
            ttsPitchRange.addEventListener('input', () => {
                ttsPitchValue.textContent = ttsPitchRange.value;
                 if (currentUtterance && speechSynth.speaking && !speechSynth.paused) {
                    speechSynth.cancel();
                    currentUtterance.pitch = parseFloat(ttsPitchRange.value);
                    speechSynth.speak(currentUtterance);
                } else if (currentUtterance && speechSynth.paused && isReadingPaused) {
                     currentUtterance.pitch = parseFloat(ttsPitchRange.value);
                }
            });
        }

        window.addEventListener('load', storeOriginalFontSizesAcc);
    </script>
</body>
</html>
